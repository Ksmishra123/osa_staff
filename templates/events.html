{% extends 'base.html' %}
{% block content %}
<h1>Events (Admin)</h1>

<p style="margin: 8px 0 16px;">
  <a href="{{ url_for('admin_new_event') }}"><button type="button">+ New Event</button></a>
</p>

<table class='table'><thead><tr><th>Date</th><th>City</th><th>Setup</th><th>Start</th><th>End</th><th>Actions</th></tr></thead><tbody>
{% for e in events %}
<tr>
<td>{{ e.date.strftime('%Y-%m-%d %H:%M') }}</td>
<td>{{ e.city }}</td>
<td>{{ e.setup_start.strftime('%Y-%m-%d %H:%M') if e.setup_start else '' }}</td>
<td>{{ e.event_start.strftime('%Y-%m-%d %H:%M') if e.event_start else '' }}</td>
<td>{{ e.event_end.strftime('%Y-%m-%d %H:%M') if e.event_end else '' }}</td>
<td><a href='{{ url_for('admin_assign', eid=e.id) }}'>Assign</a> | <a href="{{ url_for('admin_event_lodging', eid=e.id) }}">Lodging</a> | <a href="{{ url_for('admin_event_days', eid=e.id) }}">Days</a>
| <a href='{{ url_for('call_sheet', eid=e.id) }}' target='_blank'>Call Sheet</a> |<a class="btn btn-sm btn-outline-secondary" href="{{ url_for('admin_event_receipts', eid=e.id) }}">Receipts</a>
| <a href="{{ url_for('admin_event_bios', eid=e.id) }}">Print Bios</a>
<a class="btn btn-sm btn-outline-primary" href="{{ url_for('admin_edit_event', eid=e.id) }}">Edit</a>
<form method="post" action="{{ url_for('admin_toggle_publish', eid=e.id) }}" style="display:inline">
  <input type="hidden" name="publish" value="{{ 0 if e.call_sheet_published else 1 }}">
  <button class="btn btn-sm {{ 'btn-outline-secondary' if e.call_sheet_published else 'btn-success' }}">
    {{ 'Unpublish' if e.call_sheet_published else 'Publish' }}
  </button>
</form>

<form method="post" action="{{ url_for('admin_delete_event', eid=e.id) }}" style="display:inline" onsubmit="return confirm('Delete this event?');">
  <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
</form>
</td>
</tr>{% endfor %}
</tbody></table>
{% endblock %}
